(function (doc, cssText) {
    var styleEl = doc.createElement("style");
    doc.getElementsByTagName("head")[0].appendChild(styleEl);
    if (styleEl.styleSheet) {
        if (!styleEl.styleSheet.disabled) {
            styleEl.styleSheet.cssText = cssText;
        }
    } else {
        try {
            styleEl.innerHTML = cssText;
        } catch (ignore) {
            styleEl.innerText = cssText;
        }
    }
}(document, ".popover {opacity: 1 !important;}\n" +
".popover-backdrop.active{background-color: transparent !important}\n" +
"/*\n" +
"#autocomplete .item:last-child {\n" +
"    border-bottom-width: 1px !important;\n" +
"}*/"));

(function(module) {
try {
  module = angular.module('ionic-autocomplete.templates');
} catch (e) {
  module = angular.module('ionic-autocomplete.templates', []);
}
module.run(['$templateCache', function($templateCache) {
  $templateCache.put('ionic-autocomplete.html',
    ' <label class="item item-input bottom-border "><input type="text" class="" placeholder="Search" ng-change="search()" ng-model="searchData.search"></label><div class="list " ng-if="!searchData.search || !searchData.hideList "><li class="item list-border-energized" ng-repeat="item in searchData.items" ng-click="searchData.search = item[prop];searchData.hideList = true">{{item[prop]}}</li></div>');
}]);
})();

//By Ajay Parsana - ajay.parsana@gmail.com
//https://github.com/ajayparsana

(function(){
  'use strict';

  angular.module('ionic-autocomplete', ['ionic','ionic-autocomplete.templates']);
  
})();
//By Ajay Parsana - ajay.parsana@gmail.com
//https://github.com/ajayparsana

(function(){
  'use strict';

  angular.module('ionic-autocomplete', ['ionic','ionic-autocomplete.templates']);
  
})();
//By Ajay Parsana - ajay.parsana@gmail.com
//https://github.com/ajayparsana

(function () {
    'use strict';

    angular.module('ionic-autocomplete')
        .directive('ionicAutocomplete', IonicAutoComplete);

    IonicAutoComplete.$inject = ['IonicAutoCompleteService', '$ionicPopover'];

    function IonicAutoComplete(IonicAutoCompleteService, $ionicPopover) {
        return {
            restrict: 'AE',

            scope: {
                inputObj: "=inputObj"
            },
            template: '<label class="item item-input bottom-border "><input id="searchAJ" type="text" class="" placeholder="Search" ng-change="search($event)" ng-model="searchData.search"><ion-spinner ng-show="loading"></ion-spinner></label>',
            link: function (scope, element, attrs) {

                scope.searchData = {};
                scope.prop = scope.inputObj.prop? scope.inputObj.prop :'name';
                scope.isAsync = scope.inputObj.isAsync ? true :false;
                scope.list = scope.inputObj.list? scope.inputObj.list:null;
                scope.loading = false;
               
                //This will search using value in text box
                var searchFoo = function () {
                    IonicAutoCompleteService.searchString(scope.searchData.search, scope.list).then(
                        function (matches) {
                            scope.searchData.items = matches;
                            if (scope.searchData.items.length > 0) {
                                scope.searchData.hideList = true;
                                var el = angular.element("#searchAJ");
                                if (scope.popover)
                                    scope.popover.remove();
                                var template = '<ion-popover-view style="margin-left:0px;top:' + (el.offset().top + el.height()) + 'px;left:' + el.offset().left + 'px;"><ion-content id="autocomplete"><li class="item list-border-energized " ng-repeat="item in searchData.items" ng-click="searchData.search = item[prop];closePopover();" style="padding:5px">{{item[prop]}}</li></ion-content></ion-popover-view>';

                                scope.popover = $ionicPopover.fromTemplate(template, {
                                    scope: scope
                                });

                                scope.popover.show();
                            }
                        }
                    )
                };
                scope.search = function () {
                    debugger;
                    scope.searchData.hideList = true;
                    if (!scope.isAsync) {
                        searchFoo()
                    } else {
                        if(scope.inputObj.asyncHttpCall)
                        scope.loading = true;
                        scope.inputObj.asyncHttpCall(scope.searchData.search);
                    }
                    }
                };

                scope.openPopover = function ($event) {
                    scope.popover.show($event);
                };
                scope.closePopover = function () {
                    scope.popover.hide();
                };
                //Cleanup the popover when we're done with it!
                scope.$on('$destroy', function () {
                    scope.popover.remove();
                });
                //  // Execute action on hide popover
                // scope.$on('popover.hidden', function() {
                //    // Execute action
                //  });
                //  // Execute action on remove popover
                // scope.$on('popover.removed', function() {
                //    // Execute action
                //  });
                //Called when the user clicks on the button to invoke the 'ionic-autocomplete'

                scope.$root.$on('SearchListUpdated', function () {
                    scope.list = scope.inputObj.list;
                    if (scope.isAsync) {
                         scope.loading = false;
                        searchFoo();
                        
                    }
                });
                //                element.focus(function () {
                //                    debugger;
                //                    //This code is added to set passed date from autocompleteObject
                //                    scope.list = scope.inputObj.list;
                //                });
            }
        };
    }

})();
//By Ajay Parsana - ajay.parsana@gmail.com
//https://github.com/ajayparsana


(function(){
  'use strict';

  angular.module('ionic-autocomplete')
    .service('IonicAutoCompleteService', function ($q, $timeout) {

        var searchString = function (searchFilter, list) {  
            var deferred = $q.defer();
            var matches;
            if (searchFilter && list) {
                matches = list.filter(function (item) {
                    if (item.name.toLowerCase().indexOf(searchFilter.toLowerCase()) !== -1) return true;
                });

            } else {
                matches = [];
            };

            $timeout(function () {

                deferred.resolve(matches);

            }, 100);

            return deferred.promise;

        };

        return {

            searchString: searchString

        }
    });
})();